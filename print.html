<!DOCTYPE HTML>
<html lang="zh-CN" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Ind Engine 指标引擎指南</title>
        <meta name="robots" content="noindex" />
        <!-- Custom HTML head -->
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">
        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">
        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="execute/index.html"><strong aria-hidden="true">1.</strong> Get Startted</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="execute/step_mode.html"><strong aria-hidden="true">1.1.</strong> 步进模式</a></li></ol></li><li class="chapter-item expanded "><a href="language/index.html"><strong aria-hidden="true">2.</strong> Syntax - 语法</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="language/comment.html"><strong aria-hidden="true">2.1.</strong> Comment - 注释</a></li><li class="chapter-item expanded "><a href="language/metadata.html"><strong aria-hidden="true">2.2.</strong> Meta - 元数据</a></li><li class="chapter-item expanded "><a href="language/i18n.html"><strong aria-hidden="true">2.3.</strong> I18n - 国际化</a></li><li class="chapter-item expanded "><a href="language/parameter.html"><strong aria-hidden="true">2.4.</strong> Parameter - 参数</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="language/parameter/range.html"><strong aria-hidden="true">2.4.1.</strong> Range - 数值范围</a></li><li class="chapter-item expanded "><a href="language/parameter/optional.html"><strong aria-hidden="true">2.4.2.</strong> Optional - 可选值</a></li></ol></li><li class="chapter-item expanded "><a href="language/expression.html"><strong aria-hidden="true">2.5.</strong> Expression - 表达式</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="language/expr/literal.html"><strong aria-hidden="true">2.5.1.</strong> Literal - 字面量</a></li><li class="chapter-item expanded "><a href="language/expr/boolean.html"><strong aria-hidden="true">2.5.2.</strong> Boolean - 布尔值</a></li><li class="chapter-item expanded "><a href="language/expr/string.html"><strong aria-hidden="true">2.5.3.</strong> String - 字符串</a></li><li class="chapter-item expanded "><a href="language/expr/variable.html"><strong aria-hidden="true">2.5.4.</strong> Variable - 变量</a></li><li class="chapter-item expanded "><a href="language/expr/operator.html"><strong aria-hidden="true">2.5.5.</strong> Operator 运算符</a></li><li class="chapter-item expanded "><a href="language/expr/function.html"><strong aria-hidden="true">2.5.6.</strong> Function 函数</a></li><li class="chapter-item expanded "><a href="language/default_export.html"><strong aria-hidden="true">2.5.7.</strong> Default Export 默认导出</a></li><li class="chapter-item expanded "><a href="language/export_stmt.html"><strong aria-hidden="true">2.5.8.</strong> Export Variable - 导出变量</a></li></ol></li><li class="chapter-item expanded "><a href="language/draw/index.html"><strong aria-hidden="true">2.6.</strong> Draw 绘图样式</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="language/draw/chart_type.html"><strong aria-hidden="true">2.6.1.</strong> Chart 图表类型</a></li><li class="chapter-item expanded "><a href="language/draw/color.html"><strong aria-hidden="true">2.6.2.</strong> Color 颜色</a></li><li class="chapter-item expanded "><a href="language/draw/align.html"><strong aria-hidden="true">2.6.3.</strong> Alignment 文本对齐</a></li><li class="chapter-item expanded "><a href="language/draw/linethick.html"><strong aria-hidden="true">2.6.4.</strong> Linethick 线宽</a></li><li class="chapter-item expanded "><a href="language/draw/precis.html"><strong aria-hidden="true">2.6.5.</strong> Precis 小数位数</a></li><li class="chapter-item expanded "><a href="language/draw/layer.html"><strong aria-hidden="true">2.6.6.</strong> Layer 图层</a></li></ol></li></ol></li><li class="chapter-item expanded "><a href="functions/index.html"><strong aria-hidden="true">3.</strong> Built Function - 内置函数</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="functions/quote.html"><strong aria-hidden="true">3.1.</strong> Quote - 行情</a></li><li class="chapter-item expanded "><a href="functions/time.html"><strong aria-hidden="true">3.2.</strong> Time - 时间</a></li><li class="chapter-item expanded "><a href="functions/string.html"><strong aria-hidden="true">3.3.</strong> String - 字符串</a></li><li class="chapter-item expanded "><a href="functions/math.html"><strong aria-hidden="true">3.4.</strong> Math - 数学</a></li><li class="chapter-item expanded "><a href="functions/logic.html"><strong aria-hidden="true">3.5.</strong> Logic - 逻辑</a></li><li class="chapter-item expanded "><a href="functions/ref.html"><strong aria-hidden="true">3.6.</strong> Reference - 引用</a></li><li class="chapter-item expanded "><a href="functions/stat.html"><strong aria-hidden="true">3.7.</strong> Statistics - 统计</a></li><li class="chapter-item expanded "><a href="functions/ind.html"><strong aria-hidden="true">3.8.</strong> Index - 指标</a></li><li class="chapter-item expanded "><a href="functions/draw.html"><strong aria-hidden="true">3.9.</strong> Draw - 绘图</a></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Ind Engine 指标引擎指南</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="get-startted"><a class="header" href="#get-startted">Get Startted</a></h1>
<p>指标语言与普通编程语言最大的区别是，指标语言是有状态的，每次计算都会影响下一次计算的结果。</p>
<p>下面是例子用于计算成交量的总和，<code>sum</code> 函数的第二个参数周期数为 <code>0</code> 意味着从第一个值开始：</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>sumvol: sum(vol, 0);
<span class="boring">}
</span></code></pre></pre>
<p>编译指标得到 <code>Program</code> 后，使用 <code>Program::instantiate</code> 方式实例化出一个可执行的指标。</p>
<p>现在我们输入第一根 K 线，该周期成交量为 <code>10</code>：</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>instance.set_candlestick(Candlestick { time: 1, volume: 10, .. });
instance.calculate(StepMode::Step);
<span class="boring">}
</span></code></pre></pre>
<p>得到的输出结果是：</p>
<pre><code class="language-json">{ &quot;sumvol&quot;: 10 }
</code></pre>
<p>然后输入第二根 K 线，该周期成交量为 <code>5</code>：</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>instance.set_candlestick(Candlestick { time: 2, volume: 5, .. });
instance.calculate(StepMode::Step);
<span class="boring">}
</span></code></pre></pre>
<p>得到的输出结果是：</p>
<pre><code class="language-json">{ &quot;sumvol&quot;: 15 }
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="步进模式"><a class="header" href="#步进模式">步进模式</a></h1>
<h2 id="auto"><a class="header" href="#auto">Auto</a></h2>
<p>根据输入 K 线的时间戳判断，如果当前 K 线和上一根 K 线的时间戳不相等，则用上一次输入参数重新以 <code>Step</code> 模式计算一次用于步进状态机的值，然后以 <code>NoStep</code> 模式计算得到本次计算结果。</p>
<h2 id="step"><a class="header" href="#step">Step</a></h2>
<p>本次计算需要步进状态机的值。</p>
<blockquote>
<p>如果你计算的是历史数据，并且确定每次输入的 K 线时间戳都不同，那可以使用 <code>Step</code> 模式，这会避免 <code>AutoStep</code> 的重复计算提高性能。</p>
</blockquote>
<h2 id="nostep"><a class="header" href="#nostep">NoStep</a></h2>
<p>本次计算不步进状态机的值。</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="语言参考"><a class="header" href="#语言参考">语言参考</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="注释"><a class="header" href="#注释">注释</a></h1>
<p>与很多常见的语言类似，注释用 <code>//</code> 或 <code>/* */</code> 来表示。</p>
<h2 id="单行注释"><a class="header" href="#单行注释">单行注释</a></h2>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>// 我是注释

a := 1; // 我也是注释
<span class="boring">}
</span></code></pre></pre>
<h2 id="多行注释"><a class="header" href="#多行注释">多行注释</a></h2>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>/*
  我是注释 1
  我是注释 2
*/
<span class="boring">}
</span></code></pre></pre>
<h2 id="大括号"><a class="header" href="#大括号">大括号</a></h2>
<blockquote>
<p>老旧的写法，不建议使用，向下兼容其它行业里面的指标</p>
</blockquote>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>a := 1; { 我是注释 }
<span class="boring">}
</span></code></pre></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="meta---元数据定义"><a class="header" href="#meta---元数据定义">Meta - 元数据定义</a></h1>
<p>用于定义元数据，当指标编译过后可从 <code>Program</code> 中获取指定名称的原数组值，这通常用于为指标附加一些描述信息。</p>
<blockquote>
<p>NOTE: 每一个 <code>meta</code> 语句可以定义一个或者多个元数据。</p>
</blockquote>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>meta a: 10;
meta b: &quot;字符串值&quot;, c: 20;
<span class="boring">}
</span></code></pre></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="i18n---国际化"><a class="header" href="#i18n---国际化">I18n - 国际化</a></h1>
<p>以下语句定义了国际化字符串 <code>hello</code>，它支持 <code>zh-CN</code> 和 <code>en</code> 两种语言。</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>string hello: &quot;Hello&quot;(en), &quot;你好&quot;(zh-CN);
<span class="boring">}
</span></code></pre></pre>
<p>字符串插值也可以用于定义国际化字符串：</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>string length_title: `Length {n}`(en), `长度 {n}`(en);
<span class="boring">}
</span></code></pre></pre>
<p>你可以使用 <code>@id</code> 来引用国际化字符串。</p>
<p>以下语句当收盘价大于开盘价时，在收盘价位置绘制文本 <code>Hello</code> 或者 <code>你好</code>。</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>string hello: &quot;Hello&quot;(en), &quot;你好&quot;(zh-CN);

drawtext(close &gt; open, close, @hello);
<span class="boring">}
</span></code></pre></pre>
<blockquote>
<p>NOTE: 国际化字符串定义中引用的变量和引用该定义所在的语句位置有关。</p>
</blockquote>
<p>以下语句输出 <code>a</code> 和 <code>b</code> 的值并不相同：</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>string length_title: `Length {n}`(en), `长度 {n}`(en);

n := 10;
a: @length_title;

n := 20;
b: @length_title;
<span class="boring">}
</span></code></pre></pre>
<p><strong>输出：</strong></p>
<pre><code class="language-json">{
  &quot;a&quot;: &quot;Length 10&quot;,
  &quot;b&quot;: &quot;Length 20&quot;
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="parameter---参数"><a class="header" href="#parameter---参数">Parameter - 参数</a></h1>
<p>用户是实例化一个 <code>Program</code> 时可以传递参数，参数必须有默认值，类型是数值型或者字符串型。</p>
<p>以下语句定义了一个名称为 <code>a</code> 的参数，它的默认值是 <code>10</code>，参数类型为 <code>字符串</code>。</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>param a: 10;
<span class="boring">}
</span></code></pre></pre>
<h2 id="指定参数的范围"><a class="header" href="#指定参数的范围">指定参数的范围</a></h2>
<p>以下语句指定了参数 <code>a</code> 的值必须<strong>大于等于</strong> <code>50</code> 并且<strong>小于等于</strong> <code>100</code>。</p>
<p><strong>注意：只有数值型参数才能指定范围</strong></p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>param a: 10 range(50, 100);
<span class="boring">}
</span></code></pre></pre>
<h2 id="指定参数的可选值类似枚举"><a class="header" href="#指定参数的可选值类似枚举">指定参数的可选值（类似枚举）</a></h2>
<p>以下语句指定了参数 <code>a</code> 的值必须是 <code>3</code>，<code>6</code>，<code>9</code> 中的一个。</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>param a: 10 [3, 6, 9];
<span class="boring">}
</span></code></pre></pre>
<p>也可以为每个参数指定一个标题，用于在客户端中给用户更清晰的参数说明。</p>
<pre><code>param a: 10 [&quot;短&quot;: 3, &quot;中&quot;: 6, &quot;长&quot;: 9];
</code></pre>
<h2 id="为参数指定标题"><a class="header" href="#为参数指定标题">为参数指定标题</a></h2>
<p>以下语句为 <code>length</code> 参数指定了标题 <code>长度</code>。</p>
<pre><code>param length &quot;长度&quot;: 10;
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="range---参数数值范围"><a class="header" href="#range---参数数值范围">Range - 参数数值范围</a></h1>
<p>以下语句指定了参数 <code>a</code> 的值必须<strong>大于等于</strong> <code>50</code> 并且<strong>小于等于</strong> <code>100</code>。</p>
<blockquote>
<p>NOTE: 只有数值型参数才能指定范围。</p>
</blockquote>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>param a: 10 range(50, 100);
<span class="boring">}
</span></code></pre></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="optional---参数可选值类似枚举"><a class="header" href="#optional---参数可选值类似枚举">Optional - 参数可选值（类似枚举）</a></h1>
<p>以下语句指定了参数 <code>a</code> 的值必须是 <code>3</code>，<code>6</code>，<code>9</code> 中的一个。</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>param a: 10 [3, 6, 9];
<span class="boring">}
</span></code></pre></pre>
<p>也可以为每个参数指定一个标题，用于在客户端中给用户更清晰的参数说明。</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>param a: 10 [&quot;短&quot;: 3, &quot;中&quot;: 6, &quot;长&quot;: 9];
<span class="boring">}
</span></code></pre></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="expression---表达式"><a class="header" href="#expression---表达式">Expression - 表达式</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="literal---字面量"><a class="header" href="#literal---字面量">Literal - 字面量</a></h1>
<ul>
<li>数值型字面量 <code>10</code>, <code>1.23</code>, <code>1.23e-4</code>, <code>true(1)</code>, <code>false(0)</code></li>
<li>字符串型字面量 <code>&quot;abc&quot;</code></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="boolean---布尔值"><a class="header" href="#boolean---布尔值">Boolean - 布尔值</a></h1>
<p>指标语言目前没有布尔值类型，所有不等于 <code>0</code> 的数字为 <code>true</code>，否则为 <code>false</code>。</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>is_false := 0;
is_true := 1;
<span class="boring">}
</span></code></pre></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="string---字符串"><a class="header" href="#string---字符串">String - 字符串</a></h1>
<p>字符串插值主要用于拼接字符串</p>
<p>以下语句 <code>a</code> 的输出结果为 <code>&quot;abc30def&quot;</code></p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>a := &quot;Hello&quot;;
b := &quot;world&quot;;

message: a + &quot;, &quot; + b;
// Hello, world

out: `abcdef{10 + 20}`;
// abcdef30
<span class="boring">}
</span></code></pre></pre>
<p>大括号内左右空格将被忽略。</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>a: `abc{        10 + 20    }def`;
// abcdef30
<span class="boring">}
</span></code></pre></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="variable---变量"><a class="header" href="#variable---变量">Variable - 变量</a></h1>
<p>以下语句表示计算 <code>1</code> 和 变量 <code>b</code> 的和。</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>b := 8;
a := 1 + b;
// a 的值现在为 9
<span class="boring">}
</span></code></pre></pre>
<h2 id="赋值语句"><a class="header" href="#赋值语句">赋值语句</a></h2>
<p>赋值语句用于为指标内的一个临时变量赋值，如果该变量已经存在，则覆盖它原有的值。</p>
<blockquote>
<p>NOTE: 不能为参数赋值。</p>
</blockquote>
<p>以下语句为变量 <code>a</code> 赋值为 <code>10 + 20</code> 的计算结果。</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>a := 10 + 20;
// a 的值现在为 30
<span class="boring">}
</span></code></pre></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="operator---运算符"><a class="header" href="#operator---运算符">Operator - 运算符</a></h1>
<div class="table-wrapper"><table><thead><tr><th>运算符</th><th>说明</th></tr></thead><tbody>
<tr><td><code>-a</code></td><td><code>a</code> 的负数</td></tr>
<tr><td><code>a + b</code></td><td><code>a</code> 和 <code>b</code> 的和</td></tr>
<tr><td><code>a - b</code></td><td><code>a</code> 和 <code>b</code> 的差</td></tr>
<tr><td><code>a * b</code></td><td><code>a</code> 和 <code>b</code> 的积</td></tr>
<tr><td><code>a / b</code></td><td><code>a</code> 和 <code>b</code> 的商</td></tr>
<tr><td><code>a &gt; b</code></td><td>如果 <code>a</code> 大于 <code>b</code> 则结果为 <code>1</code>，否则为 <code>0</code></td></tr>
<tr><td><code>a &gt;= b</code></td><td>如果 <code>a</code> 大于等于 <code>b</code> 则结果为 <code>1</code>，否则为 <code>0</code></td></tr>
<tr><td><code>a &lt; b</code></td><td>如果 <code>a</code> 小于 <code>b</code> 则结果为 <code>1</code>，否则为 <code>0</code></td></tr>
<tr><td><code>a &lt;&gt;= b</code></td><td>如果 <code>a</code> 小于等于 <code>b</code> 则结果为 <code>1</code>，否则为 <code>0</code></td></tr>
<tr><td><code>a = b</code></td><td>如果 <code>a</code> 等于 <code>b</code> 则结果为 <code>1</code>，否则为 <code>0</code></td></tr>
<tr><td><code>a &lt;&gt; b</code>, <code>a != n</code></td><td>如果 <code>a</code> 不等于 <code>b</code> 则结果为 <code>1</code>，否则为 <code>0</code></td></tr>
<tr><td><code>a and b</code>, <code>a &amp;&amp; b</code></td><td>如果 <code>a</code> 为 <code>true</code> 并且 <code>b</code> 也为 <code>true</code> 则结果为 <code>1</code>，否则为 <code>0</code></td></tr>
<tr><td><code>a or b</code>, <code>a \|\| b</code></td><td>如果 <code>a</code> 为 <code>true</code> 或者 <code>b</code> 为 <code>true</code> 则结果为 <code>1</code>，否则为 <code>0</code></td></tr>
</tbody></table>
</div>
<blockquote>
<p>NOTE: 判断是否相等用 <code>=</code> ，而不是 <code>==</code></p>
</blockquote>
<div style="break-before: page; page-break-before: always;"></div><h1 id="function---调用函数"><a class="header" href="#function---调用函数">Function - 调用函数</a></h1>
<p>以下表达式调用 <code>max</code> 函数计算 <code>5</code> 和 <code>10</code> 的最大值。</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>max(5, 10);
<span class="boring">}
</span></code></pre></pre>
<p>如果一个函数没有参数，则可以省略 <code>()</code>，下面的例子中调用 <code>open</code> 函数获取当前周期开盘价</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>a: open;
<span class="boring">}
</span></code></pre></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="default-export---默认导出"><a class="header" href="#default-export---默认导出">Default Export - 默认导出</a></h1>
<p>如果一个指标只需要导出一个值，通常可以省略变量名，指标编译器将为该变量自动命名为 <code>@default</code>。</p>
<p>以下语句赋值 <code>10 + a</code> 的计算结果到 <code>@default</code> 变量，并导出它。</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>a := 20;
10 + a
<span class="boring">}
</span></code></pre></pre>
<blockquote>
<p>NOTE: 最后一个语句的分号可以省略。</p>
</blockquote>
<div style="break-before: page; page-break-before: always;"></div><h1 id="export---导出变量"><a class="header" href="#export---导出变量">Export - 导出变量</a></h1>
<p>导出语句类似赋值语句，但它会把该变量添加到指标的输出结果中，并且允许为该变量设置标题和样式。</p>
<p>以下语句导出 <code>a</code> 变量，并将它赋值为 <code>10 + 20</code> 的计算结果。</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>a : 10 + 20;
<span class="boring">}
</span></code></pre></pre>
<p>以下语句导出 <code>a</code> 变量的同时，设置它的绘图样式。</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>a: 10 + 20, colorred;
<span class="boring">}
</span></code></pre></pre>
<p>以下语句设置 <code>a</code> 变量的标题为 <code>均价：</code>。</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>a &quot;均价：&quot;: ma(close, 10);
<span class="boring">}
</span></code></pre></pre>
<p>你可以根据参数的输入生成不同的标题：</p>
<p>以下语句用字符串插值创建了一个标题，例如：参数 <code>n</code> 的值为 <code>5</code>，则 <code>a</code> 参数的标题为 <code>均价：5</code>。</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>a `均价{n}`: ma(close, n);
<span class="boring">}
</span></code></pre></pre>
<p><strong>注意：当你在这里使用字符串插值时，表达式内只能使用参数</strong></p>
<p>以下语句不合法，因为 <code>n + 5</code> 不是一个参数，而是一个表达式。</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>a `均价：{n + 5}`: ma(close, n);
<span class="boring">}
</span></code></pre></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="draw---绘图样式"><a class="header" href="#draw---绘图样式">Draw - 绘图样式</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="chart---图表类型"><a class="header" href="#chart---图表类型">Chart - 图表类型</a></h1>
<div class="table-wrapper"><table><thead><tr><th>名称</th><th>说明</th></tr></thead><tbody>
<tr><td><code>colorstick</code></td><td>柱状图</td></tr>
<tr><td><code>linestick</code></td><td>折线图</td></tr>
<tr><td><code>circledot</code></td><td>空心圆圈</td></tr>
<tr><td><code>volstick</code></td><td>成交量柱图，根据当前周期的涨跌情况绘制不同的颜色</td></tr>
<tr><td><code>dashline</code></td><td>虚线</td></tr>
<tr><td><code>pointdot</code></td><td>点线</td></tr>
<tr><td><code>crossdot</code></td><td>X 点</td></tr>
<tr><td><code>dotline</code></td><td>点线</td></tr>
<tr><td><code>stick3d</code></td><td>3D 柱状图</td></tr>
<tr><td><code>stick</code></td><td>柱状图</td></tr>
<tr><td><code>color3d</code></td><td>3D 柱状图</td></tr>
<tr><td><code>sarline</code></td><td>SAR 指标专用圆圈线，根据当前周期的涨跌情况绘制不同的颜色</td></tr>
</tbody></table>
</div>
<p>以下语句指定了 <code>a</code> 的图标类型为柱状图。</p>
<pre><code>a: 10, colorstick;
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="color---颜色"><a class="header" href="#color---颜色">Color - 颜色</a></h1>
<p>指定 <code>a</code> 的颜色样式为红色。</p>
<pre><code>a: colorff0000;
</code></pre>
<p>指定 <code>a</code> 为 颜色样式为 <code>red</code>。</p>
<p><code>red</code> 是一个代号，具体对应的颜色由绘图端决定。</p>
<pre><code>a: colorred;
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="align---文本对齐"><a class="header" href="#align---文本对齐">Align - 文本对齐</a></h1>
<div class="table-wrapper"><table><thead><tr><th>名称</th><th>说明</th></tr></thead><tbody>
<tr><td><code>align0</code></td><td>左对齐</td></tr>
<tr><td><code>align1</code></td><td>横向居中对齐</td></tr>
<tr><td><code>align2</code></td><td>右对齐</td></tr>
<tr><td><code>valign0</code></td><td>顶部对齐</td></tr>
<tr><td><code>valign1</code></td><td>纵向居中对齐</td></tr>
<tr><td><code>valign2</code></td><td>底部对齐</td></tr>
</tbody></table>
</div><div style="break-before: page; page-break-before: always;"></div><h1 id="linethick---线宽"><a class="header" href="#linethick---线宽">Linethick - 线宽</a></h1>
<p><code>linethick[n]</code>，<code>n</code> 必须大于 <code>0</code> 小于等于 <code>255</code>，对应实际的画图线宽由绘图端决定。</p>
<p>以下语句指定了 <code>a</code> 为折线图，线宽为 <code>5</code>。</p>
<pre><code>a: linestick, linethick5;
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="precis---小数位数"><a class="header" href="#precis---小数位数">Precis - 小数位数</a></h1>
<p><code>precis[n]</code>，<code>n</code> 必须大于 <code>0</code> 小于等于 <code>255</code>，用于指定保留的小数精度。</p>
<p>以下语句指定了 <code>a</code> 保留 <code>3</code> 位小数。</p>
<pre><code>a: precis3;
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="layout---图层序号"><a class="header" href="#layout---图层序号">Layout - 图层序号</a></h1>
<p><code>layer[n]</code>，<code>n</code> 必须大于 <code>0</code> 小于等于 <code>65535</code>，用于指定该图形的图层，数值越大则越靠前。</p>
<p>以下语句指定了 <code>a</code> 的图形应该在 <code>b</code> 前面。</p>
<pre><code>a: layer1;
b: layer0;
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="built-function---内置函数"><a class="header" href="#built-function---内置函数">Built Function - 内置函数</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="quote---行情函数"><a class="header" href="#quote---行情函数">Quote - 行情函数</a></h1>
<div class="table-wrapper"><table><thead><tr><th>函数名</th><th>说明</th></tr></thead><tbody>
<tr><td><code>open</code>, <code>o</code></td><td>当前周期开盘价</td></tr>
<tr><td><code>high</code>, <code>h</code></td><td>当前周期最高价</td></tr>
<tr><td><code>low</code>, <code>l</code></td><td>当前周期最低价</td></tr>
<tr><td><code>close</code>, <code>c</code></td><td>当前周期收盘价</td></tr>
<tr><td><code>volume</code>, <code>vol</code>,<code>v</code></td><td>当前周期成交量</td></tr>
<tr><td><code>amount</code>, <code>vola</code>, <code>turnover</code></td><td>当前周期成交额</td></tr>
<tr><td><code>isup</code></td><td>如果当前周期上涨则结果为 <code>1</code></td></tr>
<tr><td><code>isdown</code></td><td>如果当前周期下跌则结果为 <code>1</code></td></tr>
<tr><td><code>isequal</code></td><td>如果当前周期平盘则结果为 <code>1</code></td></tr>
</tbody></table>
</div><div style="break-before: page; page-break-before: always;"></div><h1 id="time---时间函数"><a class="header" href="#time---时间函数">Time - 时间函数</a></h1>
<div class="table-wrapper"><table><thead><tr><th>函数名</th><th>说明</th></tr></thead><tbody>
<tr><td><code>date</code>, <code>date(t)</code></td><td>获取当前 K 线时间或指定时间戳的日期整数 <code>YYMMDD</code></td></tr>
<tr><td><code>year</code>, <code>year(t)</code></td><td>获取当前 K 线时间或指定时间戳的年</td></tr>
<tr><td><code>month</code>, <code>month(t)</code></td><td>获取当前 K 线时间或指定时间戳的月</td></tr>
<tr><td><code>day</code>, <code>day(t)</code></td><td>获取当前 K 线时间或指定时间戳的日</td></tr>
<tr><td><code>time</code>, <code>time(t)</code></td><td>获取当前 K 线时间或指定时间戳的时间整数 HHMMSS</td></tr>
<tr><td><code>hour</code>, <code>hour(t)</code></td><td>获取当前 K 线时间或指定时间戳的小时</td></tr>
<tr><td><code>minute</code>, <code>minute(t)</code></td><td>获取当前 K 线时间或指定时间戳的分</td></tr>
<tr><td><code>second</code>, <code>second(t)</code></td><td>获取当前 K 线时间或指定时间戳的秒</td></tr>
<tr><td><code>weekday</code>, <code>weekday(t)</code></td><td>获取当前 K 线时间或指定时间戳的星期，<code>0</code> 为星期天</td></tr>
<tr><td><code>second</code>, <code>second(t)</code></td><td>获取当前 K 线时间或指定时间戳的为一年的第几周</td></tr>
</tbody></table>
</div><div style="break-before: page; page-break-before: always;"></div><h1 id="string---字符串函数"><a class="header" href="#string---字符串函数">String - 字符串函数</a></h1>
<div class="table-wrapper"><table><thead><tr><th>函数名</th><th>说明</th></tr></thead><tbody>
<tr><td><code>datestr(x)</code></td><td>以格式 <code>YY-MM-DD</code> 格式化日期整数 YYMMDD</td></tr>
<tr><td><code>lowercase(x)</code></td><td>转换为小写字符串</td></tr>
<tr><td><code>uppercase(x)</code></td><td>转换为大写字符串</td></tr>
<tr><td><code>numtostr(x)</code></td><td>转换数值为字符串</td></tr>
<tr><td><code>numtostrn(x, n)</code></td><td>转换数值为字符串，精确到小数点后 <code>n</code> 位</td></tr>
<tr><td><code>strtonum</code>(x)</td><td>解析字符串为数值</td></tr>
<tr><td><code>concat(x1, x2, x3, ...)</code></td><td>连接字符串</td></tr>
</tbody></table>
</div><div style="break-before: page; page-break-before: always;"></div><h1 id="math---数学函数"><a class="header" href="#math---数学函数">Math - 数学函数</a></h1>
<div class="table-wrapper"><table><thead><tr><th>函数名</th><th>说明</th></tr></thead><tbody>
<tr><td><code>abs(n)</code></td><td>取 <code>n</code> 的绝对值</td></tr>
<tr><td><code>acos(n)</code></td><td>取 <code>n</code> 的反余弦值</td></tr>
<tr><td><code>asin(n)</code></td><td>取 <code>n</code> 的反正弦值</td></tr>
<tr><td><code>atan(n)</code></td><td>取 <code>n</code> 的反正切值</td></tr>
<tr><td><code>ceiling(n)</code></td><td>取 <code>n</code> 向数值增大方向最接近的整数</td></tr>
<tr><td><code>floor(n)</code></td><td>取 <code>n</code> 向数值减少方向最接近的整数</td></tr>
<tr><td><code>round(n)</code></td><td>取 <code>n</code> 四舍五入到个位的值</td></tr>
<tr><td><code>cos(n)</code></td><td>取 <code>n</code> 的余弦值</td></tr>
<tr><td><code>exp(n)</code></td><td>取 <code>e</code> 的 <code>n</code> 次幂</td></tr>
<tr><td><code>fracpart(n)</code></td><td>取 <code>n</code> 数值的小数部分</td></tr>
<tr><td><code>intpart(n)</code></td><td>取 <code>n</code> 数值的整数部分</td></tr>
<tr><td><code>ln(n)</code></td><td>取 <code>n</code> 的以 <code>e</code> 为底的对数</td></tr>
<tr><td><code>log(n)</code></td><td>取 <code>n</code> 的对数</td></tr>
<tr><td><code>sin(n)</code></td><td>取 <code>n</code> 的正弦值</td></tr>
<tr><td><code>sqrt(n)</code></td><td>取 <code>n</code> 的平方根</td></tr>
<tr><td><code>tan(n)</code></td><td>取 <code>n</code> 的正切值</td></tr>
<tr><td><code>max(n1, n2, ..)</code></td><td>取输入参数的最大值</td></tr>
<tr><td><code>min(n1, n2, ..)</code></td><td>取输入参数的最小值</td></tr>
<tr><td><code>mod(a, b)</code></td><td>取 <code>a</code> 除以 <code>b</code> 的余数</td></tr>
<tr><td><code>pow(a, b)</code></td><td>取 <code>a</code> 的 <code>b</code> 次幂</td></tr>
<tr><td><code>reverse(n)</code></td><td>改变 <code>n</code> 的改变符号位</td></tr>
<tr><td><code>sgn(n)</code>, <code>sign(n)</code></td><td>取 <code>n</code> 的取符号位，当 <code>n&gt;0</code>, <code>n=0</code>, <code>m&lt;0</code> 分别返回 <code>1</code>, <code>0</code>, <code>-1</code></td></tr>
</tbody></table>
</div><div style="break-before: page; page-break-before: always;"></div><h1 id="logic---逻辑函数"><a class="header" href="#logic---逻辑函数">Logic - 逻辑函数</a></h1>
<div class="table-wrapper"><table><thead><tr><th>函数名</th><th>说明</th></tr></thead><tbody>
<tr><td><code>not(n)</code></td><td>当 <code>n</code> 为 <code>true</code> 时返回 <code>0</code>，否则返回 <code>1</code></td></tr>
<tr><td><code>between(a, b, c)</code>, <code>range(a, b, c)</code></td><td>当 <code>a</code> 处于 <code>b</code> 和 <code>c</code> 之间时返回 <code>1</code>，否则返回 <code>0</code></td></tr>
<tr><td><code>if(x, a, b)</code>, <code>ifs(x, a, b)</code>, <code>iff(x, a, b)</code></td><td>当 <code>x</code> 为 <code>true</code> 时返回 <code>a</code>，否则返回 <code>b</code></td></tr>
<tr><td><code>ifn(x, a, b)</code></td><td>当 <code>x</code> 为 <code>true</code> 时返回 <code>b</code>，否则返回 <code>a</code></td></tr>
<tr><td><code>cross(a, b)</code></td><td>当 <code>a</code> 从下方上穿过 <code>b</code> 时返回 <code>1</code>，否则返回 <code>0</code></td></tr>
<tr><td><code>longcross(a, b, n)</code></td><td>当 <code>a</code> 在 <code>n</code> 周期内都小于 <code>b</code>，本周期 <code>a</code> 从下方上穿过 <code>b</code> 时返回 <code>1</code>，否则返回 <code>0</code></td></tr>
<tr><td><code>valuewhen(x, n)</code></td><td>当 <code>x</code> 为 <code>true</code> 时，取 <code>n</code> 的当前值，否则取 <code>n</code> 的上一个值</td></tr>
<tr><td><code>switch(x1, n1, x2, n2, ...)</code></td><td>当 <code>x1</code> 为 <code>true</code> 时，取 <code>n1</code> 的值，当 <code>x2</code> 为 <code>true</code> 时返回 <code>n2</code> 的值，依此类推</td></tr>
<tr><td><code>orelse(x, y)</code></td><td>当 <code>x</code> 有效时返回 <code>x</code>，否则返回 <code>y</code></td></tr>
</tbody></table>
</div><div style="break-before: page; page-break-before: always;"></div><h1 id="reference---引用函数"><a class="header" href="#reference---引用函数">Reference - 引用函数</a></h1>
<div class="table-wrapper"><table><thead><tr><th>函数名</th><th>说明</th></tr></thead><tbody>
<tr><td><code>all(x, n)</code></td><td>当 <code>n</code> 周期内 <code>x</code> 全部为 <code>true</code>，则返回 <code>1</code>，否则返回 <code>0</code>。<code>n</code> 为 <code>0</code> 则表示从第一个有效值开始</td></tr>
<tr><td><code>any(x, n)</code></td><td>当 <code>n</code> 周期内 <code>x</code> 至少有一个 <code>true</code>，则返回 <code>1</code>，否则返回 <code>0</code>。<code>n</code> 为 <code>0</code> 则表示从第一个有效值开始</td></tr>
<tr><td><code>barslast(x)</code></td><td>取 <code>x</code> 上一次为 <code>true</code> 时到现在的周期数</td></tr>
<tr><td><code>barssince(x)</code></td><td>取 <code>x</code> 第一次为 <code>true</code> 到现在的周期数</td></tr>
<tr><td><code>count(x, n)</code></td><td>取 <code>n</code> 周期内 <code>x</code> 为 <code>true</code> 的次数，<code>n</code> 为 <code>0</code> 则表示从第一个有效值开始</td></tr>
<tr><td><code>dma(x, n)</code></td><td>求 <code>x</code> 的 动态移动平均</td></tr>
<tr><td><code>ema(x, n)</code></td><td>求 <code>x</code> 的 <code>n</code> 日指数平滑移动平均</td></tr>
<tr><td><code>filter(x, n)</code></td><td>当 <code>x</code> 为 <code>true</code> 后返回 <code>1</code>，并且其后 <code>n</code> 周期都总是返回 <code>0</code></td></tr>
<tr><td><code>hhv(x, n)</code></td><td>求 <code>n</code> 周期内 <code>x</code> 的最大值，<code>n</code> 为 <code>0</code> 则表示从第一个有效值开始</td></tr>
<tr><td><code>hhvbars(x, n)</code></td><td>求 <code>n</code> 周期内 <code>x</code> 的最大值到当前的周期数，<code>n</code> 为 <code>0</code> 则表示从第一个有效值开始</td></tr>
<tr><td><code>llv(x, n)</code></td><td>求 <code>n</code> 周期内 <code>x</code> 的最小值，<code>n</code> 为 <code>0</code> 则表示从第一个有效值开始</td></tr>
<tr><td><code>llvbars(x, n)</code></td><td>求 <code>n</code> 周期内 <code>x</code> 的最小值到当前的周期数，<code>n</code> 为 <code>0</code> 则表示从第一个有效值开始</td></tr>
<tr><td><code>sum(x, n)</code></td><td>统计 <code>n</code> 周期内 <code>x</code> 的总和，<code>n</code> 为 <code>0</code> 则表示从第一个有效值开始</td></tr>
<tr><td><code>mular(x, n)</code></td><td>统计 <code>n</code> 周期内 <code>x</code> 的乘积，<code>n</code> 为 <code>0</code> 则表示从第一个有效值开始</td></tr>
<tr><td><code>ref(x, n)</code></td><td>引用 <code>n</code> 周期前的 <code>x</code> 值</td></tr>
<tr><td><code>ma(x, n)</code></td><td>取 <code>n</code> 周期内 <code>x</code> 的简单平均值，<code>n</code> 为 <code>0</code> 则表示从第一个有效值开始</td></tr>
<tr><td><code>mema(x, n)</code></td><td>取 <code>n</code> 周期内 <code>x</code> 的改良指数平滑移动平均值</td></tr>
<tr><td><code>sma(x, n)</code></td><td>取 <code>n</code> 周期内 <code>x</code> 的移动平均值</td></tr>
<tr><td><code>tma(x, n)</code></td><td>取 <code>n</code> 周期内 <code>x</code> 的递归移动平均值</td></tr>
<tr><td><code>wma(x, n)</code></td><td>取 <code>n</code> 周期内 <code>x</code> 的加权移动平均值</td></tr>
<tr><td><code>barscount(x)</code></td><td>取 <code>x</code> 第一个有效值到当前的周期数</td></tr>
<tr><td><code>last(x)</code></td><td>统计 <code>x</code> 连续为 <code>true</code> 的周期数</td></tr>
<tr><td><code>sumbars(a, b)</code></td><td>求 <code>a</code> 向前累加直到大于等于 <code>b</code> 的周期数</td></tr>
<tr><td><code>hod(x, n)</code></td><td>求当前 <code>x</code> 是 <code>n</code> 周期内的第几个高值</td></tr>
<tr><td><code>lod(x, n)</code></td><td>求当前 <code>x</code> 是 <code>n</code> 周期内的第几个低值</td></tr>
</tbody></table>
</div><div style="break-before: page; page-break-before: always;"></div><h1 id="statistics---统计函数"><a class="header" href="#statistics---统计函数">Statistics - 统计函数</a></h1>
<div class="table-wrapper"><table><thead><tr><th>函数名</th><th>说明</th></tr></thead><tbody>
<tr><td><code>avedev(x, n)</code></td><td>求 <code>x</code> 的 <code>n</code> 周期平均绝对方差</td></tr>
<tr><td><code>devsq(x, n)</code></td><td>求 <code>x</code> 的 <code>n</code> 周期数据偏差平方和</td></tr>
<tr><td><code>forcast(x, n)</code></td><td>求 <code>x</code> 的 <code>n</code> 周期线性回归预测值</td></tr>
<tr><td><code>slope(x, n)</code></td><td>求 <code>x</code> 的 <code>n</code> 周期线性回归线的斜率</td></tr>
<tr><td><code>std(x, n)</code></td><td>求 <code>x</code> 的 <code>n</code> 周期估算标准差</td></tr>
<tr><td><code>stddev(x, n)</code></td><td>求 <code>x</code> 的 <code>n</code> 周期标准差</td></tr>
<tr><td><code>stdp(x, n)</code></td><td>求 <code>x</code> 的 <code>n</code> 周期总体标准差</td></tr>
<tr><td><code>var(x, n)</code></td><td>求 <code>x</code> 的 <code>n</code> 周期估算样本方差</td></tr>
<tr><td><code>varp(x, n)</code></td><td>求 <code>x</code> 的 <code>n</code> 周期总体样本方差</td></tr>
<tr><td><code>covar(x, y, n)</code></td><td>求 <code>x</code> 和 <code>y</code> 的 <code>n</code> 周期协方差</td></tr>
<tr><td><code>relate(x, y, n)</code></td><td>求 <code>x</code> 和 <code>y</code> 的 <code>n</code> 周期相关系数</td></tr>
</tbody></table>
</div><div style="break-before: page; page-break-before: always;"></div><h1 id="index---指标函数"><a class="header" href="#index---指标函数">Index - 指标函数</a></h1>
<div class="table-wrapper"><table><thead><tr><th>函数名</th><th>说明</th></tr></thead><tbody>
<tr><td><code>sar(n, s, m)</code></td><td>求抛物转向指标，<code>n</code> 为计算周期，<code>s</code> 为步长，<code>m</code> 为极值</td></tr>
<tr><td><code>sarturn(n, s, m)</code></td><td>求抛物转向点，<code>n</code> 为计算周期，<code>s</code> 为步长，<code>m</code> 为极值，若发生向上转向则返回 <code>1</code>，若发生向下转向则返回 <code>-1</code>，否则返回 <code>0</code></td></tr>
</tbody></table>
</div><div style="break-before: page; page-break-before: always;"></div><h1 id="draw---绘图函数"><a class="header" href="#draw---绘图函数">Draw - 绘图函数</a></h1>
<div class="table-wrapper"><table><thead><tr><th>函数名</th><th>说明</th></tr></thead><tbody>
<tr><td><code>rgb(r, g, b)</code></td><td>返回颜色值，参数 <code>r</code>，<code>g</code>，<code>b</code> 的范围必须是大于 <code>0</code> 小于 <code>255</code></td></tr>
<tr><td><code>drawmovetext(x, t)</code></td><td>当 <code>x</code> 为 <code>true</code> 时，在窗口指标数值栏目位置绘制随光标移动的文字 <code>t</code></td></tr>
<tr><td><code>drawtext(x, p, t)</code></td><td>当 <code>x</code> 为 <code>true</code> 时，在价格 <code>p</code> 位置绘制文本 <code>t</code></td></tr>
<tr><td><code>fillrgn(p1, p2, cond1, color1, cond2, color2, ...)</code></td><td>填充 <code>p1</code> 到 <code>p2</code> 之间的区域，当 <code>cond1</code> 为 <code>true</code> 时用 <code>color1</code>，当 <code>cond2</code> 为 <code>true</code> 时使用 <code>color2</code>，依此类推</td></tr>
<tr><td><code>partline(p, cond1, color1, cond2, color2, ...)</code></td><td>当 <code>x</code> 为 <code>true</code> 时，在价格 <code>p</code> 位置画线，当 <code>cond1</code> 为 <code>true</code> 时用 <code>color1</code>，当 <code>cond2</code> 为 <code>true</code> 时使用 <code>color2</code>，依此类推</td></tr>
<tr><td><code>percentbar(p1, p2)</code></td><td>绘制柱状线，<code>p1</code> 表示柱状线高度，<code>p2</code> 表示对比量高度，两者取值必须在 <code>0</code> 到 <code>100</code> 之间</td></tr>
<tr><td><code>tiptext(x, p, t)</code></td><td>当 <code>x</code> 为 <code>true</code> 时，在 <code>p</code> 价格位置绘制文本，</td></tr>
<tr><td><code>vertline(x, t)</code></td><td>当 <code>x</code> 为 <code>true</code>，沿垂直方向绘制 <code>t</code> 类型的线段，<code>0</code> 表示实线，<code>1</code> 表示虚线，<code>2</code> 表示点线，<code>3</code> 表表示点划线，<code>4</code> 表示点点划线</td></tr>
<tr><td><code>stickline(x, p1, p2, width, hollow)</code></td><td>当 <code>x</code> 为 <code>true</code> 时，在 <code>p1</code> 和 <code>p2</code> 位置画柱线，宽度为 <code>width</code>当 <code>hollow</code> 为 <code>true</code> 时为空心柱，否则为实心柱</td></tr>
<tr><td><code>drawicon(x, p, id)</code></td><td>当 <code>x</code> 为 <code>true</code> 时，在 <code>p</code> 位置画指定 <code>id</code> 的图标</td></tr>
</tbody></table>
</div>
                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
            </nav>

        </div>

        <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        <script src="elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="searcher.js" type="text/javascript" charset="utf-8"></script>
        <script src="clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        <script type="text/javascript">
        window.addEventListener('load', function() {
            window.setTimeout(window.print, 100);
        });
        </script>
    </body>
</html>
